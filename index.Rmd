---
title: "ETC5521 Assignment 1"
subtitle: "Your title"
team: taipan
author:
  - Helen Evangelina
  - Yiwen Jiang
date: "`r Sys.Date()`"
output: 
  html_document
---

```{r setup, echo=FALSE}
library(tidyverse)
library(kableExtra)
```


[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

# Data description

The data set tracks woodland caribou in northern British Columbia published by the Movebank Data Repository at https://www.datarepository.movebank.org/handle/10255/move.955. 
It consists of almost 250,000 location tags of 260 caribou, from 1988 to 2016.  
 
The boreal woodland caribou (Rangifer tarandus caribou), also known as woodland caribou, boreal forest caribou and forest-dwelling caribou, is a North American subspecies of the reindeer (or the caribou in North America) with the vast majority of animals in Canada. They prefer lichen-rich mature forests and mainly live in marshes, bogs, lakes and river regions. Caribou are considered an ancient member of the deer family Cervidae (Banfield 1974). They are smaller than Moose (Alces americanus) and Elk (Cervus canadensis), standing 1.0â€“1.2 m high at the shoulder (Thomas and Gray 2002). Due to the caribou is classified as "Vulnerable" on the International Union for the Conservation of Nature's (IUCN) Red List. The data provided for the study of the B.C. Ministry of Environment & Climate Change to report the management and recovery of the caribou.  

Because this data set is used for analysing the reproduction of species, the data is obtained by observation rather than experiment. There is no treatment group and the control group. The time frame of collection was started from 1988 and end of 2016. The data sets were separated into two data files and provided by .csv format. The following are the variables in each data.  


- The `individual` data comes from _Mountain caribou in British Columbia-reference-data.csv_. The data contains the relevant information of 286 caribou. The variables are showing in the following table: 

```{r individual_table, echo=FALSE}
individual_info <- tibble(Variable = c("animal_id", "sex", "life_stage", "pregnant", "with_calf", 
                                       "death_cause", "study_site", "deploy_on_longitude", 
                                       "deploy_on_latitude", "deploy_on_comments", "deploy_off_longitude",
                                       "deploy_off_latitude", "deploy_off_type", "deploy_off_comments"),
                          Class = c("character", "character", "character", 
                                    "logical", "logical", "character", "character", 
                                    "double", "double", "character", "double", 
                                    "double", "character", "character"),
                          Description = c("Individual identifier for animal", "Sex of animal", 
                                          "Age class (in years) at beginning of deployment", 
                                          "Whether animal was pregnant at beginning of deployment", 
                                          "Whether animal had a calf at time of deployment", 
                                          "Cause of death",
                                          "Deployment site or colony, or a location-related group such as the herd or pack name",
                                          "Longitude where animal was released at beginning of deployment",
                                          "Latitude where animal was released at beginning of deployment",
                                          "Additional information about tag deployment",
                                          "Longitude where deployment ended",
                                          "Latitude where deployment ended",
                                          "Classification of tag deployment end (see table below for full description", 
                                          "Additional information about tag deployment end")) 

kable(individual_info) %>%
  kable_styling(bootstrap_options = "striped", 
                full_width = F, 
                position = "left")
```

- The `location` comes from _Mountain caribou in British Columbia-gps.csv_. The data contains location information of each counted caribous for every 4 fours.

```{r locations_table, echo=FALSE}
locations_info <- tibble(Variable = c("event_id", "animal_id", "study_site", "season", "timestamp", "longitude", "latitude"),
                          Class = c("double", "character", "character", "character", "datetime", "double", "double"),
                          Description = c("Identifier for an individual measurement", 
                                          "Individual identifier for animal", 
                                          "Deployment site or colony, or a location-related group such as the herd or pack name", 
                                          "Season (Summer/Winter) at time of measurement", 
                                          "Date and time of measurement",
                                          "Longitude of measurement",
                                          "Latitude of measurement")) 

kable(locations_info) %>%
  kable_styling(bootstrap_options = "striped", 
                full_width = F, 
                position = "left")
```


```{r read_data}
# Get the Data

individuals <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-06-23/individuals.csv')
locations <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-06-23/locations.csv')

# Or read in with tidytuesdayR package (https://github.com/thebioengineer/tidytuesdayR)

# Either ISO-8601 date or year/week works!

# Install via devtools::install_github("thebioengineer/tidytuesdayR")

tuesdata <- tidytuesdayR::tt_load('2020-06-23')
tuesdata <- tidytuesdayR::tt_load(2020, week = 26)


individuals <- tuesdata$individuals
```

```{r data_cleaning, eval=FALSE}
# Load libraries
library(tidyverse)
library(janitor)

# Import data
individuals_raw <- read_csv("./caribou-location-tracking/raw/Mountain caribou in British Columbia-reference-data.csv")
locations_raw <- read_csv("./caribou-location-tracking/raw/Mountain caribou in British Columbia-gps.csv")

# Clean individuals
individuals <- individuals_raw %>%
  clean_names() %>%
  transmute(animal_id,
            sex = animal_sex,
            # Getting rid of whitespace to address inconsistent spacing
            # NOTE: life stage is as of the beginning of deployment
            life_stage = str_remove_all(animal_life_stage, " "),
            reproductive_condition = animal_reproductive_condition,
            # Cause of death "cod" is embedded in a comment field
            death_cause = str_remove(animal_death_comments, ".*cod "),
            study_site,
            deploy_on_longitude,
            deploy_on_latitude,
            # Renaming to maintain consistency "deploy_on_FIELD" and "deploy_off_FIELD"
            deploy_on_comments = deployment_comments,
            deploy_off_longitude,
            deploy_off_latitude,
            deploy_off_type = deployment_end_type,
            deploy_off_comments = deployment_end_comments) %>%
  # reproductive_condition actually has two dimensions
  separate(reproductive_condition, into = c("pregnant", "with_calf"), sep = ";", fill = "left") %>%
  mutate(pregnant = str_remove(pregnant, "pregnant: ?"),
         with_calf = str_remove(with_calf, "with calf: ?")) %>%
  # TRUE and FALSE are indicated by Yes/No or Y/N
  mutate_at(vars(pregnant:with_calf), ~ case_when(str_detect(., "Y") ~ TRUE,
                                                   str_detect(., "N") ~ FALSE,
                                                   TRUE ~ NA))

# Clean locations
locations <- locations_raw %>%
  clean_names() %>%
  transmute(event_id,
            animal_id = individual_local_identifier,
            study_site = comments,
            season = study_specific_measurement,
            timestamp,
            longitude = location_long,
            latitude = location_lat)

# Write to CSV
write_csv(individuals, "./caribou-location-tracking/individuals.csv")
write_csv(locations, "./caribou-location-tracking/locations.csv")
```


# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

# References
